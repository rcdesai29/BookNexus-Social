{"ast":null,"code":"import{useEffect,useState}from'react';import{directApiService}from'../services/directApi';export function useGoogleBooksSimple(){let query=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'bestsellers';let maxResults=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;let startIndex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;const[data,setData]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[totalItems,setTotalItems]=useState(0);useEffect(()=>{setLoading(true);setError(null);const fetchBooks=async()=>{try{console.log('Fetching books with query:',query);const response=await directApiService.getGoogleBooks(query,maxResults);const convertedBooks=(response.items||[]).map(item=>{var _item$industryIdentif,_item$industryIdentif2,_item$industryIdentif3,_item$industryIdentif4,_item$authors,_item$imageLinks;// Backend returns flattened structure, not wrapped in volumeInfo\nconst isbn=item.isbn13||item.isbn10||((_item$industryIdentif=item.industryIdentifiers)===null||_item$industryIdentif===void 0?void 0:(_item$industryIdentif2=_item$industryIdentif.find(id=>id.type==='ISBN_13'))===null||_item$industryIdentif2===void 0?void 0:_item$industryIdentif2.identifier)||((_item$industryIdentif3=item.industryIdentifiers)===null||_item$industryIdentif3===void 0?void 0:(_item$industryIdentif4=_item$industryIdentif3.find(id=>id.type==='ISBN_10'))===null||_item$industryIdentif4===void 0?void 0:_item$industryIdentif4.identifier)||'';return{id:item.id,title:item.title||'Unknown Title',authorName:((_item$authors=item.authors)===null||_item$authors===void 0?void 0:_item$authors.join(', '))||'Unknown Author',isbn:isbn,synopsis:item.description||'No description available.',cover:((_item$imageLinks=item.imageLinks)===null||_item$imageLinks===void 0?void 0:_item$imageLinks.thumbnail)||null,publishedDate:item.publishedDate,pageCount:item.pageCount,categories:item.categories,averageRating:item.averageRating||0,ratingsCount:item.ratingsCount||0,isGoogleBook:true,googleBookId:item.id};});// Be very lenient with filtering to show more books\nconst filteredBooks=convertedBooks.filter(book=>book.ratingsCount===0||book.ratingsCount>=1);console.log('Converted books:',filteredBooks);setData(filteredBooks);setTotalItems(response.totalItems||filteredBooks.length);}catch(err){console.error('Error fetching books:',err);setError(err);}finally{setLoading(false);}};fetchBooks();},[query,maxResults,startIndex]);return{data,loading,error,totalItems};}","map":{"version":3,"names":["useEffect","useState","directApiService","useGoogleBooksSimple","query","arguments","length","undefined","maxResults","startIndex","data","setData","loading","setLoading","error","setError","totalItems","setTotalItems","fetchBooks","console","log","response","getGoogleBooks","convertedBooks","items","map","item","_item$industryIdentif","_item$industryIdentif2","_item$industryIdentif3","_item$industryIdentif4","_item$authors","_item$imageLinks","isbn","isbn13","isbn10","industryIdentifiers","find","id","type","identifier","title","authorName","authors","join","synopsis","description","cover","imageLinks","thumbnail","publishedDate","pageCount","categories","averageRating","ratingsCount","isGoogleBook","googleBookId","filteredBooks","filter","book","err"],"sources":["/Users/cluckbucks/projects/booknexus-social/frontend/src/hooks/useGoogleBooksSimple.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { directApiService } from '../services/directApi';\n\nexport interface GoogleBook {\n  id: string;\n  title: string;\n  authorName: string;\n  isbn: string;\n  synopsis: string;\n  cover: string | null;\n  publishedDate?: string;\n  pageCount?: number;\n  categories?: string[];\n  averageRating: number;\n  ratingsCount: number;\n  isGoogleBook: boolean;\n  googleBookId: string;\n}\n\nexport function useGoogleBooksSimple(\n  query: string = 'bestsellers',\n  maxResults: number = 20,\n  startIndex: number = 0\n) {\n  const [data, setData] = useState<GoogleBook[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<any>(null);\n  const [totalItems, setTotalItems] = useState<number>(0);\n\n  useEffect(() => {\n    setLoading(true);\n    setError(null);\n    \n    const fetchBooks = async () => {\n      try {\n        console.log('Fetching books with query:', query);\n        const response = await directApiService.getGoogleBooks(query, maxResults);\n\n        const convertedBooks = (response.items || []).map((item: any) => {\n          // Backend returns flattened structure, not wrapped in volumeInfo\n          const isbn = item.isbn13 || item.isbn10 || \n                       item.industryIdentifiers?.find((id: any) => id.type === 'ISBN_13')?.identifier ||\n                       item.industryIdentifiers?.find((id: any) => id.type === 'ISBN_10')?.identifier ||\n                       '';\n\n          return {\n            id: item.id,\n            title: item.title || 'Unknown Title',\n            authorName: item.authors?.join(', ') || 'Unknown Author',\n            isbn: isbn,\n            synopsis: item.description || 'No description available.',\n            cover: item.imageLinks?.thumbnail || null,\n            publishedDate: item.publishedDate,\n            pageCount: item.pageCount,\n            categories: item.categories,\n            averageRating: item.averageRating || 0,\n            ratingsCount: item.ratingsCount || 0,\n            isGoogleBook: true,\n            googleBookId: item.id\n          };\n        });\n\n        // Be very lenient with filtering to show more books\n        const filteredBooks = convertedBooks.filter((book: GoogleBook) => \n          book.ratingsCount === 0 || book.ratingsCount >= 1\n        );\n\n        console.log('Converted books:', filteredBooks);\n        setData(filteredBooks);\n        setTotalItems(response.totalItems || filteredBooks.length);\n      } catch (err) {\n        console.error('Error fetching books:', err);\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchBooks();\n  }, [query, maxResults, startIndex]);\n\n  return { data, loading, error, totalItems };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}