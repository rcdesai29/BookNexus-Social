{"ast":null,"code":"import{Alert,Box,Button,CircularProgress,List,ListItem,ListItemText,Rating,TextField,Typography}from'@mui/material';import React,{useEffect,useState}from'react';import{FeedbackService}from'../app/services/services/FeedbackService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookFeedback=_ref=>{let{bookId}=_ref;const[feedbacks,setFeedbacks]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[review,setReview]=useState('');const[rating,setRating]=useState(null);const[submitting,setSubmitting]=useState(false);const[submitError,setSubmitError]=useState(null);const[success,setSuccess]=useState(false);const fetchFeedbacks=()=>{setLoading(true);FeedbackService.findAllFeedbacksByBook(bookId).then(res=>setFeedbacks(res.content||[])).catch(err=>{var _err$body;return setError((err===null||err===void 0?void 0:(_err$body=err.body)===null||_err$body===void 0?void 0:_err$body.message)||'Failed to load feedback');}).finally(()=>setLoading(false));};useEffect(()=>{fetchFeedbacks();// eslint-disable-next-line\n},[bookId]);const handleSubmit=async e=>{e.preventDefault();setSubmitError(null);setSuccess(false);setSubmitting(true);try{await FeedbackService.saveFeedback({bookId,review,rating:rating!==null&&rating!==void 0?rating:undefined});setSuccess(true);setReview('');setRating(null);fetchFeedbacks();}catch(err){var _err$body2;setSubmitError((err===null||err===void 0?void 0:(_err$body2=err.body)===null||_err$body2===void 0?void 0:_err$body2.message)||'Failed to submit feedback');}finally{setSubmitting(false);}};return/*#__PURE__*/_jsxs(Box,{sx:{mt:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Reviews & Ratings\"}),loading&&/*#__PURE__*/_jsx(CircularProgress,{}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsx(List,{children:feedbacks.map((fb,idx)=>/*#__PURE__*/_jsx(ListItem,{divider:true,children:/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Rating,{value:fb.rating,readOnly:true}),secondary:fb.review})},idx))}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSubmit,sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:\"Leave a Review\"}),/*#__PURE__*/_jsx(Rating,{value:rating,onChange:(_,value)=>setRating(value),precision:0.5,sx:{mb:1}}),/*#__PURE__*/_jsx(TextField,{label:\"Review\",value:review,onChange:e=>setReview(e.target.value),fullWidth:true,multiline:true,rows:2,sx:{mb:1}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:submitting||!rating||!review,children:submitting?'Submitting...':'Submit'}),submitError&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mt:1},children:submitError}),success&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mt:1},children:\"Feedback submitted!\"})]})]});};export default BookFeedback;","map":{"version":3,"names":["Alert","Box","Button","CircularProgress","List","ListItem","ListItemText","Rating","TextField","Typography","React","useEffect","useState","FeedbackService","jsx","_jsx","jsxs","_jsxs","BookFeedback","_ref","bookId","feedbacks","setFeedbacks","loading","setLoading","error","setError","review","setReview","rating","setRating","submitting","setSubmitting","submitError","setSubmitError","success","setSuccess","fetchFeedbacks","findAllFeedbacksByBook","then","res","content","catch","err","_err$body","body","message","finally","handleSubmit","e","preventDefault","saveFeedback","undefined","_err$body2","sx","mt","children","variant","gutterBottom","severity","mb","map","fb","idx","divider","primary","value","readOnly","secondary","component","onSubmit","onChange","_","precision","label","target","fullWidth","multiline","rows","type","disabled"],"sources":["/Users/rahildesai/Projects/BookNexus/frontend/src/components/BookFeedback.tsx"],"sourcesContent":["import { Alert, Box, Button, CircularProgress, List, ListItem, ListItemText, Rating, TextField, Typography } from '@mui/material';\nimport React, { useEffect, useState } from 'react';\nimport { FeedbackService } from '../app/services/services/FeedbackService';\n\ninterface BookFeedbackProps {\n  bookId: number;\n}\n\nconst BookFeedback: React.FC<BookFeedbackProps> = ({ bookId }) => {\n  const [feedbacks, setFeedbacks] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [review, setReview] = useState('');\n  const [rating, setRating] = useState<number | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const fetchFeedbacks = () => {\n    setLoading(true);\n    FeedbackService.findAllFeedbacksByBook(bookId)\n      .then(res => setFeedbacks(res.content || []))\n      .catch(err => setError(err?.body?.message || 'Failed to load feedback'))\n      .finally(() => setLoading(false));\n  };\n\n  useEffect(() => {\n    fetchFeedbacks();\n    // eslint-disable-next-line\n  }, [bookId]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setSubmitError(null);\n    setSuccess(false);\n    setSubmitting(true);\n    try {\n      await FeedbackService.saveFeedback({ bookId, review, rating: rating ?? undefined });\n      setSuccess(true);\n      setReview('');\n      setRating(null);\n      fetchFeedbacks();\n    } catch (err: any) {\n      setSubmitError(err?.body?.message || 'Failed to submit feedback');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <Box sx={{ mt: 4 }}>\n      <Typography variant=\"h6\" gutterBottom>Reviews & Ratings</Typography>\n      {loading && <CircularProgress />}\n      {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\n      <List>\n        {feedbacks.map((fb, idx) => (\n          <ListItem key={idx} divider>\n            <ListItemText\n              primary={<Rating value={fb.rating} readOnly />} \n              secondary={fb.review}\n            />\n          </ListItem>\n        ))}\n      </List>\n      <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 2 }}>\n        <Typography variant=\"subtitle1\">Leave a Review</Typography>\n        <Rating\n          value={rating}\n          onChange={(_, value) => setRating(value)}\n          precision={0.5}\n          sx={{ mb: 1 }}\n        />\n        <TextField\n          label=\"Review\"\n          value={review}\n          onChange={e => setReview(e.target.value)}\n          fullWidth\n          multiline\n          rows={2}\n          sx={{ mb: 1 }}\n        />\n        <Button type=\"submit\" variant=\"contained\" disabled={submitting || !rating || !review}>\n          {submitting ? 'Submitting...' : 'Submit'}\n        </Button>\n        {submitError && <Alert severity=\"error\" sx={{ mt: 1 }}>{submitError}</Alert>}\n        {success && <Alert severity=\"success\" sx={{ mt: 1 }}>Feedback submitted!</Alert>}\n      </Box>\n    </Box>\n  );\n};\n\nexport default BookFeedback; "],"mappings":"AAAA,OAASA,KAAK,CAAEC,GAAG,CAAEC,MAAM,CAAEC,gBAAgB,CAAEC,IAAI,CAAEC,QAAQ,CAAEC,YAAY,CAAEC,MAAM,CAAEC,SAAS,CAAEC,UAAU,KAAQ,eAAe,CACjI,MAAO,CAAAC,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,eAAe,KAAQ,0CAA0C,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAM3E,KAAM,CAAAC,YAAyC,CAAGC,IAAA,EAAgB,IAAf,CAAEC,MAAO,CAAC,CAAAD,IAAA,CAC3D,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGV,QAAQ,CAAQ,EAAE,CAAC,CACrD,KAAM,CAACW,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACa,KAAK,CAAEC,QAAQ,CAAC,CAAGd,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAACe,MAAM,CAAEC,SAAS,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACiB,MAAM,CAAEC,SAAS,CAAC,CAAGlB,QAAQ,CAAgB,IAAI,CAAC,CACzD,KAAM,CAACmB,UAAU,CAAEC,aAAa,CAAC,CAAGpB,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACqB,WAAW,CAAEC,cAAc,CAAC,CAAGtB,QAAQ,CAAgB,IAAI,CAAC,CACnE,KAAM,CAACuB,OAAO,CAAEC,UAAU,CAAC,CAAGxB,QAAQ,CAAC,KAAK,CAAC,CAE7C,KAAM,CAAAyB,cAAc,CAAGA,CAAA,GAAM,CAC3Bb,UAAU,CAAC,IAAI,CAAC,CAChBX,eAAe,CAACyB,sBAAsB,CAAClB,MAAM,CAAC,CAC3CmB,IAAI,CAACC,GAAG,EAAIlB,YAAY,CAACkB,GAAG,CAACC,OAAO,EAAI,EAAE,CAAC,CAAC,CAC5CC,KAAK,CAACC,GAAG,OAAAC,SAAA,OAAI,CAAAlB,QAAQ,CAAC,CAAAiB,GAAG,SAAHA,GAAG,kBAAAC,SAAA,CAAHD,GAAG,CAAEE,IAAI,UAAAD,SAAA,iBAATA,SAAA,CAAWE,OAAO,GAAI,yBAAyB,CAAC,GAAC,CACvEC,OAAO,CAAC,IAAMvB,UAAU,CAAC,KAAK,CAAC,CAAC,CACrC,CAAC,CAEDb,SAAS,CAAC,IAAM,CACd0B,cAAc,CAAC,CAAC,CAChB;AACF,CAAC,CAAE,CAACjB,MAAM,CAAC,CAAC,CAEZ,KAAM,CAAA4B,YAAY,CAAG,KAAO,CAAAC,CAAkB,EAAK,CACjDA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClBhB,cAAc,CAAC,IAAI,CAAC,CACpBE,UAAU,CAAC,KAAK,CAAC,CACjBJ,aAAa,CAAC,IAAI,CAAC,CACnB,GAAI,CACF,KAAM,CAAAnB,eAAe,CAACsC,YAAY,CAAC,CAAE/B,MAAM,CAAEO,MAAM,CAAEE,MAAM,CAAEA,MAAM,SAANA,MAAM,UAANA,MAAM,CAAIuB,SAAU,CAAC,CAAC,CACnFhB,UAAU,CAAC,IAAI,CAAC,CAChBR,SAAS,CAAC,EAAE,CAAC,CACbE,SAAS,CAAC,IAAI,CAAC,CACfO,cAAc,CAAC,CAAC,CAClB,CAAE,MAAOM,GAAQ,CAAE,KAAAU,UAAA,CACjBnB,cAAc,CAAC,CAAAS,GAAG,SAAHA,GAAG,kBAAAU,UAAA,CAAHV,GAAG,CAAEE,IAAI,UAAAQ,UAAA,iBAATA,UAAA,CAAWP,OAAO,GAAI,2BAA2B,CAAC,CACnE,CAAC,OAAS,CACRd,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED,mBACEf,KAAA,CAAChB,GAAG,EAACqD,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAAC,QAAA,eACjBzC,IAAA,CAACN,UAAU,EAACgD,OAAO,CAAC,IAAI,CAACC,YAAY,MAAAF,QAAA,CAAC,mBAAiB,CAAY,CAAC,CACnEjC,OAAO,eAAIR,IAAA,CAACZ,gBAAgB,GAAE,CAAC,CAC/BsB,KAAK,eAAIV,IAAA,CAACf,KAAK,EAAC2D,QAAQ,CAAC,OAAO,CAACL,EAAE,CAAE,CAAEM,EAAE,CAAE,CAAE,CAAE,CAAAJ,QAAA,CAAE/B,KAAK,CAAQ,CAAC,cAChEV,IAAA,CAACX,IAAI,EAAAoD,QAAA,CACFnC,SAAS,CAACwC,GAAG,CAAC,CAACC,EAAE,CAAEC,GAAG,gBACrBhD,IAAA,CAACV,QAAQ,EAAW2D,OAAO,MAAAR,QAAA,cACzBzC,IAAA,CAACT,YAAY,EACX2D,OAAO,cAAElD,IAAA,CAACR,MAAM,EAAC2D,KAAK,CAAEJ,EAAE,CAACjC,MAAO,CAACsC,QAAQ,MAAE,CAAE,CAC/CC,SAAS,CAAEN,EAAE,CAACnC,MAAO,CACtB,CAAC,EAJWoC,GAKL,CACX,CAAC,CACE,CAAC,cACP9C,KAAA,CAAChB,GAAG,EAACoE,SAAS,CAAC,MAAM,CAACC,QAAQ,CAAEtB,YAAa,CAACM,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAAC,QAAA,eAC1DzC,IAAA,CAACN,UAAU,EAACgD,OAAO,CAAC,WAAW,CAAAD,QAAA,CAAC,gBAAc,CAAY,CAAC,cAC3DzC,IAAA,CAACR,MAAM,EACL2D,KAAK,CAAErC,MAAO,CACd0C,QAAQ,CAAEA,CAACC,CAAC,CAAEN,KAAK,GAAKpC,SAAS,CAACoC,KAAK,CAAE,CACzCO,SAAS,CAAE,GAAI,CACfnB,EAAE,CAAE,CAAEM,EAAE,CAAE,CAAE,CAAE,CACf,CAAC,cACF7C,IAAA,CAACP,SAAS,EACRkE,KAAK,CAAC,QAAQ,CACdR,KAAK,CAAEvC,MAAO,CACd4C,QAAQ,CAAEtB,CAAC,EAAIrB,SAAS,CAACqB,CAAC,CAAC0B,MAAM,CAACT,KAAK,CAAE,CACzCU,SAAS,MACTC,SAAS,MACTC,IAAI,CAAE,CAAE,CACRxB,EAAE,CAAE,CAAEM,EAAE,CAAE,CAAE,CAAE,CACf,CAAC,cACF7C,IAAA,CAACb,MAAM,EAAC6E,IAAI,CAAC,QAAQ,CAACtB,OAAO,CAAC,WAAW,CAACuB,QAAQ,CAAEjD,UAAU,EAAI,CAACF,MAAM,EAAI,CAACF,MAAO,CAAA6B,QAAA,CAClFzB,UAAU,CAAG,eAAe,CAAG,QAAQ,CAClC,CAAC,CACRE,WAAW,eAAIlB,IAAA,CAACf,KAAK,EAAC2D,QAAQ,CAAC,OAAO,CAACL,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAAC,QAAA,CAAEvB,WAAW,CAAQ,CAAC,CAC3EE,OAAO,eAAIpB,IAAA,CAACf,KAAK,EAAC2D,QAAQ,CAAC,SAAS,CAACL,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAAC,QAAA,CAAC,qBAAmB,CAAO,CAAC,EAC7E,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAtC,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}